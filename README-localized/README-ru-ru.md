# Пример использования API контактов в Python #

Этот пример представляет собой текущий проект, направленный на достижение двух целей: показать, как просто пользоваться [API Office 365](http://msdn.microsoft.com/en-us/office/office365/api/api-catalog) c Python и помочь мне изучить Python и Django. Несколько важных примечаний:

- Я — абсолютный новичок в Python и Django. Если не считать приложение для проведения опросов, которое входит в [Руководство по Django](https://docs.djangoproject.com/en/1.7/intro/tutorial01/), это мое первое приложение Python. Поэтому мои решения могут оказываться не самыми оптимальными с точки зрения Python. Буду благодарен за замечания по этому поводу!
- Для этого примера я решил использовать [API контактов](http://msdn.microsoft.com/office/office365/APi/contacts-rest-operations). Однако такая методология будет работать для всех API REST.
- Я использовал встроенный сервер разработки Django, и этот пример еще не тестировался на производственных серверах.
- Я использовал тестовую базу данных, которая появилась при создании проекта Django, поэтому все, что сохраняется в качестве базы данных — это локальный файл на компьютере разработчика.

## Необходимое программное обеспечение ##

- [Python 3.4.2](https://www.python.org/downloads/)
- [Django 1.7.1](https://docs.djangoproject.com/en/1.7/intro/install/)
- [Запросы: HTTP for Humans](http://docs.python-requests.org/en/latest/)

## Запуск примера ##

Предполагается, что вы установили Python и Django перед началом. Пользователям Windows следует добавить каталог установки и подкаталог сценариев Python в переменную среду PATH.

1. Скачайте проект приложения или создайте вилку.
2. Откройте командную строку или оболочку в каталоге, в котором находится `manage.py`.
3. Если возможно запускать файлы BAT, запустите setup\_project. bat. Если нет, запустите три команды в файле вручную. Последняя команда предложит вам создать суперпользователь, для входа в систему позже.
4. Установите библиотеку Requests: Модуль HTTP for Humans из командной строки: `pip install requests`
5. [Зарегистрируйте приложение в Azure Active Directory](https://github.com/jasonjoh/office365-azure-guides/blob/master/RegisterAnAppInAzure.md). Приложение нужно регистрировать как веб-приложение с URL-адресом для входа "http://127.0.0.1:8000/contacts", при этом нужно предоставить разрешение на "Чтение контактов пользователей".
6. Измените файл `.\contacts\clientreg.py`. Скопируйте идентификатор клиента, полученный при регистрации приложения, и вставьте его в качестве значения переменной `id`. Скопируйте ключ, созданный при регистрации приложения, и вставьте его в качестве значения переменной `secret`. Сохраните файл.
7. Запустите сервер разработки: `python manage.py runserver`
8. Вы увидите:
Выполнение системных проверок...
    
    Проверка системы не обнаружила ошибок (0).
	18 декабря 2014 г. 12:36:32
	Django версии 1.7.1, использованы параметры 'pythoncontacts.settings'
	Запуск сервера разработки на http://127.0.0.1:8000/
	Выход с сервера с помощью CTRL-BREAK.
9. Перейдите на страницу http://127.0.0.1:8000/contacts, используя браузер.
10. Войдите в свою учетную запись суперпользователя.
11. Появится предложение о подключении учетной записи Office 365. Нажмите на ссылку, чтобы подтвердить это действие, и войдите через свою учетную запись Office 365.
12. Отобразится таблица со списком контактов, имеющихся в вашей учетной записи Office 365. Создать новый контакт можно, щелкнув кнопку "Создать контакт". Имеющиеся контакты можно "Редактировать" или "Удалить" с помощью соответствующих кнопок.
13. Чтобы узнать, что хранится в базе данных Django пользователя, перейдите на http://127.0.0.1:8000/admin и щелкните ссылку подключений Office 365. Запись пользователя с сайта администратора можно удалить, если процесс подтверждения необходимо пройти заново.

## Журнал выпусков ##

Любую конкретную версию выпуска можно найти здесь: https://github.com/jasonjoh/pythoncontacts/releases

- **1.2: Функции Почты и Календаря.** В модуль службы o365 теперь включен определенный функционал API Почты и API Календаря. Эти функции не отображаются в пользовательском интерфейсе, но их можно вызвать с помощью новых тестовых классов, добавленных в test.py. Кроме того, добавлены отметки для отключения проверки SSL-сертификата, чтобы можно было записывать запросы и ответы с помощью Fiddler. ([Запись блога](http://blogs.msdn.com/b/exchangedev/archive/2015/01/15/office-365-apis-and-python-part-3-mail-and-calendar-api.aspx))
- **1.1: Функции Контактов.** Теперь в приложении содержится список контактов, и пользователь может создавать новые контакты и редактировать или удалять существующие. ([Запись блога](http://blogs.msdn.com/b/exchangedev/archive/2015/01/09/office-365-apis-and-python-part-2-contacts-api.aspx))
- **1.0: Первый выпуск.** Через приложение пользователь может связать учетную запись Office 365 c локальной учетной записью в приложении. Приложение создает поток предоставления кода OAuth2 и выводит маркер доступа для пользователя. ([Запись блога](http://blogs.msdn.com/b/exchangedev/archive/2015/01/05/office-365-apis-and-python-part-1-oauth2.aspx))

## Авторские права ##

(c) Корпорация Майкрософт (Microsoft Corporation). Все права защищены.

----------
Работайте со мной на сайте Twitter [@JasonJohMSFT](https://twitter.com/JasonJohMSFT)

Следуйте инструкциям в [блоге разработчиков Exchange](http://blogs.msdn.com/b/exchangedev/)